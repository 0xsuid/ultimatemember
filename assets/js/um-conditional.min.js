function condition_fields(){var t=JSON.parse(JSON.stringify(jQuery(".condition-data").data("conds")));jQuery.each(t,function(e){var l=0,f=[],m="show";jQuery.each(t[e],function(){var e,i=this[0],t=this[1],n=this[2],a=this[3],r=this[5],u=jQuery('.um-field[data-key="'+t+'"] .um-field-area input'),s=jQuery('.um-field[data-key="'+t+'"] .um-field-area>select'),c=jQuery('.um-field[data-key="'+t+'"] .um-field-area>textarea'),o=jQuery('.um-field[data-key="'+t+'"] .um-field-block'),h=[],d=jQuery('.um-field[data-key="'+t+'"] .um-field-value');if(0<u.length&&0===s.length)u.is(":checkbox")?jQuery('.um-field[data-key="'+t+'"] input:checked').each(function(){var e=jQuery(this).val();h.push(e)}):u.is(":radio")?e=jQuery('.um-field[data-key="'+t+'"] input:checked').val():u.is(":hidden")?"empty_file"===(e=jQuery('.um-field[data-key="'+t+'"] input').val())&&(e=""):e=u.val();else if(0<s.length){!0===s.prop("multiple")?0<jQuery.inArray(a,s.val())?e=a:h=s.val():e=0<jQuery.inArray(a,s.val())?a:s.val()}else 0<c.length?e=c.val():0<o.length?e=o.text():0<d.length&&(d.hasClass("um-field-value-multiselect")||d.hasClass("um-field-value-checkbox")?h=d.text().split(", "):e=d.text());if(parseInt(r)!==l){if("show"===i)switch(n){case"equals to":h&&0<h.length?jQuery.each(h,function(){if(this==a)return!(m="show");m="hide"}):m=e==a?"show":"hide";break;case"not equals":h&&0<h.length?jQuery.each(h,function(){if(!this||this==a)return!(m="hide");m="show"}):m=e!=a?"show":"hide";break;case"empty":m=h&&0<h.length?0===h.length?"show":"hide":e&&""!==e?"hide":"show";break;case"not empty":m=h&&0<h.length?0<h.length?"show":"hide":e&&""!==e?"show":"hide";break;case"greater than":h&&0<h.length?jQuery.each(h,function(){if(jQuery.isNumeric(a)&&jQuery.isNumeric(this)){if(parseInt(a)<parseInt(this))return!(m="show");m="hide"}else m="hide"}):m=jQuery.isNumeric(a)&&jQuery.isNumeric(e)&&parseInt(a)<parseInt(e)?"show":"hide";break;case"less than":h&&0<h.length?jQuery.each(h,function(){if(jQuery.isNumeric(a)&&jQuery.isNumeric(this)){if(parseInt(a)>parseInt(this))return!(m="show");m="hide"}else m="hide"}):m=jQuery.isNumeric(a)&&jQuery.isNumeric(e)&&parseInt(a)>parseInt(e)?"show":"hide";break;case"contains":h&&0<h.length?jQuery.each(h,function(){if(this&&0<=this.search(a))return!(m="show");m="hide"}):m=e&&0<=e.search(a)?"show":"hide"}else switch(n){case"equals to":h&&0<h.length?jQuery.each(h,function(){if(this==a)return!(m="hide");m="show"}):m=e==a?"hide":"show";break;case"not equals":h&&0<h.length?jQuery.each(h,function(){if(!this||this==a)return!(m="show");m="hide"}):m=e!=a?"hide":"show";break;case"empty":m=h&&0<h.length?0===h.length?"hide":"show":e&&""!==e?"show":"hide";break;case"not empty":m=h&&0<h.length?0<h.length?"hide":"show":e&&""!==e?"hide":"show";break;case"greater than":h&&0<h.length?jQuery.each(h,function(){if(jQuery.isNumeric(a)&&jQuery.isNumeric(this)){if(parseInt(a)<parseInt(this))return!(m="hide");m="show"}else m="show"}):m=jQuery.isNumeric(a)&&jQuery.isNumeric(e)&&parseInt(a)<parseInt(e)?"hide":"show";break;case"less than":h&&0<h.length?jQuery.each(h,function(){if(jQuery.isNumeric(a)&&jQuery.isNumeric(this)){if(parseInt(a)>parseInt(this))return!(m="hide");m="show"}else m="show"}):m=jQuery.isNumeric(a)&&jQuery.isNumeric(e)&&parseInt(a)>parseInt(e)?"hide":"show";break;case"contains":h&&0<h.length?jQuery.each(h,function(){if(this&&0<=this.search(a))return!(m="hide");m="show"}):m=e&&0<=e.search(a)?"hide":"show"}l++,f.push(m)}else{if("show"===i)switch(n){case"equals to":h&&0<h.length?jQuery.each(h,function(){if(this==a)return!(m="show");m="hide"}):m=e==a?"show":"hide";break;case"not equals":h&&0<h.length?jQuery.each(h,function(){if(!this||this==a)return!(m="hide");m="show"}):m=e!=a?"show":"hide";break;case"empty":m=h&&0<h.length?0===h.length?"show":"hide":e&&""!==e?"hide":"show";break;case"not empty":m=h&&0<h.length?0<h.length?"show":"hide":e&&""!==e?"show":"hide";break;case"greater than":h&&0<h.length?jQuery.each(h,function(){if(jQuery.isNumeric(a)&&jQuery.isNumeric(this)){if(parseInt(a)<parseInt(this))return!(m="show");m="hide"}else m="hide"}):m=jQuery.isNumeric(a)&&jQuery.isNumeric(e)&&parseInt(a)<parseInt(e)?"show":"hide";break;case"less than":h&&0<h.length?jQuery.each(h,function(){if(jQuery.isNumeric(a)&&jQuery.isNumeric(this)){if(parseInt(a)>parseInt(this))return!(m="show");m="hide"}else m="hide"}):m=jQuery.isNumeric(a)&&jQuery.isNumeric(e)&&parseInt(a)>parseInt(e)?"show":"hide";break;case"contains":h&&0<h.length?jQuery.each(h,function(){if(this&&0<=this.search(a))return!(m="show");m="hide"}):m=e&&0<=e.search(a)?"show":"hide"}else switch(n){case"equals to":h&&0<h.length?jQuery.each(h,function(){if(this&&this==a)return!(m="hide");m="show"}):m=e==a?"hide":"show";break;case"not equals":h&&0<h.length?jQuery.each(h,function(){if(!this||this==a)return!(m="show");m="hide"}):m=e!=a?"hide":"show";break;case"empty":m=h&&0<h.length?0===h.length?"hide":"show":e&&""!==e?"show":"hide";break;case"not empty":m=h&&0<h.length?0<h.length?"hide":"show":e&&""!==e?"hide":"show";break;case"greater than":h&&0<h.length?jQuery.each(h,function(){if(jQuery.isNumeric(a)&&jQuery.isNumeric(this)){if(parseInt(a)<parseInt(this))return!(m="hide");m="show"}else m="show"}):m=jQuery.isNumeric(a)&&jQuery.isNumeric(e)&&parseInt(a)<parseInt(e)?"hide":"show";break;case"less than":h&&0<h.length?jQuery.each(h,function(){if(jQuery.isNumeric(a)&&jQuery.isNumeric(this)){if(parseInt(a)>parseInt(this))return!(m="hide");m="show"}else m="show"}):m=jQuery.isNumeric(a)&&jQuery.isNumeric(e)&&parseInt(a)>parseInt(e)?"hide":"show";break;case"contains":h&&0<h.length?jQuery.each(h,function(){if(this&&0<=this.search(a))return!(m="hide");m="show"}):m=e&&0<=e.search(a)?"hide":"show"}f[l]?"show"===f[l]&&"show"===m?f[l]="show":f[l]="hide":f[l]="show"===m?"show":"hide"}});var i=jQuery('.um-field[data-key="'+e+'"]');jQuery.inArray("show",f)<0?(i.hide(),i.find("input, textarea").attr("disabled","disabled").attr("readonly","readonly")):(i.show(),i.find("input, textarea").removeAttr("disabled").removeAttr("readonly"))})}function check_parent(){var e=JSON.parse(JSON.stringify(jQuery(".condition-data").data("conds")));jQuery.each(e,function(r){var u=0,s=[];jQuery.each(e[r],function(){var e,i=this[1],t=this[5],n=jQuery('.um-field[data-key="'+i+'"]').is(":visible"),a=jQuery('.um-field[data-key="'+r+'"]');u!==parseInt(t)?(e=!1===n?"hide":"show",u++,s.push(e)):(e=!1===n?"hide":"show",s[u]?"show"===s[u]&&"show"===e?s[u]="show":s[u]="hide":s[u]="show"===e?"show":"hide"),jQuery.inArray("show",s)<0?a.addClass("hide-after-parent-check"):a.removeClass("hide-after-parent-check")})})}var arr_all_conditions=[],um_field_conditions={},um_field_default_values={};function um_get_field_default_value(e){var i="",t=um_get_field_type(e);switch(t){case"text":case"number":case"date":case"textarea":case"select":i=e.find("input:text,input[type=number],textarea,select").val();break;case"multiselect":i=e.find("select").val();break;case"radio":1<=e.find("input[type=radio]:checked").length&&(i=e.find("input[type=radio]:checked").val());break;case"checkbox":1<=e.find("input[type=checkbox]:checked").length&&(1<e.find("input[type=checkbox]:checked").length?e.find("input[type=checkbox]:checked").each(function(){i=i+jQuery(this).val()+" "}):i=e.find("input[type=checkbox]:checked").val())}return{type:t,value:i}}function um_get_field_element(e){switch(um_get_field_type(e)){case"text":case"number":case"date":case"textarea":case"select":case"multiselect":case"radio":case"checkbox":return e.find("input,textarea,select")}return""}function um_get_field_type(e){var t="",i=e.attr("class");return jQuery.each(i.split(" "),function(e,i){-1!=i.indexOf("um-field-type")&&(t=i.split("_")[1])}),t}function um_get_field_children(t){var n=[];return jQuery.each(arr_all_conditions,function(e,i){i.field.parent==t&&n.push(i.field.condition)}),n}function um_splitup_array(e,i){for(var t=e.length%i,n=t,a=Math.floor(e.length/i),r=[],u=0;u<e.length;u+=a){var s=a+u,c=!1;0!==t&&n&&(s++,n--,c=!0),r.push(e.slice(u,s)),c&&u++}var o=[];return jQuery.each(r,function(e,i){o.push({action:i[0],if_field:i[1],operator:i[2],value:i[3]})}),o}function um_get_field_data(e){return um_live_field=e.parents(".um-field").data("key"),um_live_value=e.val(),e.is(":checkbox")&&(um_live_value="",1<e.parents(".um-field").find("input:checked").length?e.parents(".um-field").find("input:checked").each(function(){um_live_value=um_live_value+jQuery(this).val()+" "}):1<=e.parents(".um-field").find("input:checked").length&&(um_live_value=e.parents(".um-field").find("input:checked").val())),e.is(":radio")&&(um_live_value=e.parents(".um-field").find("input[type=radio]:checked").val()),um_live_value}function um_in_array(e,i,t){var n,a=!1;t=!!t;for(n in i)if(t&&i[n]===e||!t&&i[n]==e){a=!0;break}return a}function um_apply_conditions(t,e){var i=t.parents(".um-field[data-key]").data("key"),n=um_field_conditions[i],a=um_get_field_data(t),r={},u={},s={};jQuery.each(n,function(e,i){void 0===u[i.owner]&&(u[i.owner]=[],s[i.owner]={}),u[i.owner].push(i.value),s[i.owner]=i}),jQuery.each(n,function(e,i){void 0===r[i.owner]&&(r[i.owner]={}),"empty"==i.operator&&(!a||""==a&&um_in_array(a,u[i.owner])?r[i.owner][e]=!0:r[i.owner][e]=!1),"not empty"==i.operator&&(a&&""!=a&&!um_in_array(a,u[i.owner])?r[i.owner][e]=!0:r[i.owner][e]=!1),"equals to"==i.operator&&(i.value==a&&um_in_array(a,u[i.owner])?r[i.owner][e]=!0:r[i.owner][e]=!1),"not equals"==i.operator&&(jQuery.isNumeric(i.value)&&parseInt(a)!=parseInt(i.value)&&a&&!um_in_array(a,u[i.owner])?r[i.owner][e]=!0:i.value==a||um_in_array(a,u[i.owner])?r[i.owner][e]=!1:r[i.owner][e]=!0),"greater than"==i.operator&&(jQuery.isNumeric(i.value)&&parseInt(a)>parseInt(i.value)?r[i.owner][e]=!0:r[i.owner][e]=!1),"less than"==i.operator&&(jQuery.isNumeric(i.value)&&parseInt(a)<parseInt(i.value)?r[i.owner][e]=!0:r[i.owner][e]=!1),"contains"==i.operator&&("multiselect"==um_get_field_type(t.parents(".um-field[data-key]"))?a&&0<=a.indexOf(i.value)&&um_in_array(i.value,a)?r[i.owner][e]=!0:r[i.owner][e]=!1:"checkbox"==um_get_field_type(t.parents(".um-field[data-key]"))?a&&0<=a.indexOf(i.value)?r[i.owner][e]=!0:r[i.owner][e]=!1:a&&0<=a.indexOf(i.value)&&um_in_array(a,u[i.owner])?r[i.owner][e]=!0:r[i.owner][e]=!1)}),jQuery.each(r,function(e,i){um_in_array(!0,i)?um_field_apply_action(t,s[e],!0):um_field_apply_action(t,s[e],!1)}),t.trigger("um_fields_change")}function um_field_apply_action(e,i,t){var n=jQuery('div.um-field[data-key="'+i.owner+'"]');"show"==i.action&&t&&(n.show(),_show_in_ie(n),um_field_restore_default_value(n)),"show"!=i.action||t||(n.hide(),_hide_in_ie(n)),"hide"==i.action&&t&&(n.hide(),_hide_in_ie(n)),"hide"!=i.action||t||(n.show(),_show_in_ie(n),um_field_restore_default_value(n)),e.removeClass("um-field-has-changed")}function um_field_restore_default_value(n){var e=um_get_field_type(n),i=n.data("key"),t=um_field_default_values[i];switch(e){case"text":case"number":case"date":case"textarea":n.find("input:text,input[type=number],textareas").val(t.value);break;case"select":n.find("select").find("option").prop("selected",!1),n.find("select").val(t.value),n.find("select").trigger("change");break;case"multiselect":n.find("select").find("option").prop("selected",!1),jQuery.each(t.value,function(e,i){n.find("select").find('option[value="'+i+'"]').attr("selected",!0)}),n.find("select").trigger("change");break;case"checkbox":if(1<=n.find("input[type=checkbox]:checked").length)if(n.find("input[type=checkbox]:checked").removeAttr("checked"),n.find("span.um-field-checkbox-state i").removeClass("um-icon-android-checkbox-outline"),n.find("span.um-field-checkbox-state i").addClass("um-icon-android-checkbox-outline-blank"),n.find(".um-field-checkbox.active").removeClass("active"),jQuery.isArray(t.value))jQuery.each(t.value,function(e,i){var t=n.find('input[type=checkbox][value="'+i+'"]');t.attr("checked",!0),t.closest(".um-field-checkbox").find("i").removeClass("um-icon-android-checkbox-outline-blank"),t.closest(".um-field-checkbox").find("i").addClass("um-icon-android-checkbox-outline"),t.closest(".um-field-checkbox").addClass("active")});else{var a=n.find('input[type=checkbox][value="'+t.value+'"]');a.attr("checked",!0),a.closest(".um-field-checkbox").find("i").removeClass("um-icon-android-checkbox-outline-blank"),a.closest(".um-field-checkbox").find("i").addClass("um-icon-android-checkbox-outline"),a.closest(".um-field-checkbox").addClass("active")}break;case"radio":1<=n.find("input[type=radio]:checked").length&&setTimeout(function(){n.find("input[type=radio]:checked").removeAttr("checked"),n.find("span.um-field-radio-state i").removeClass("um-icon-android-radio-button-on"),n.find("span.um-field-radio-state i").addClass("um-icon-android-radio-button-off"),n.find(".um-field-radio.active").removeClass("active");var e=n.find("input[type=radio][value='"+t.value+"']");e.attr("checked",!0),e.closest(".um-field-radio").find("i").removeClass("um-icon-android-radio-button-off"),e.closest(".um-field-radio").find("i").addClass("um-icon-android-radio-button-on"),e.closest(".um-field-radio").addClass("active")},100)}if(!n.hasClass("um-field-has-changed")){var r=um_get_field_element(n);"radio"!=e&&"checkbox"!=e||(r=r.find(":checked")),r&&(r.trigger("change"),n.addClass("um-field-has-changed"))}}function um_field_hide_siblings(){jQuery.each(um_field_conditions,function(e,i){(1<=jQuery('.um-field[data-key="'+e+'"]:hidden').length||"none"==jQuery('.um-field[data-key="'+e+'"]').css("display"))&&jQuery.each(i,function(e,i){jQuery('.um-field[data-key="'+i.owner+'"]').hide()})})}function _hide_in_ie(e){void 0!==jQuery.browser&&jQuery.browser.msie&&e.css({visibility:"hidden"})}function _show_in_ie(e){void 0!==jQuery.browser&&jQuery.browser.msie&&e.css({visibility:"visible"})}function um_init_field_conditions(){var e=[];jQuery(".um-field[data-key]").each(function(){var n=jQuery(this).data("key");e.push(n);var r={};jQuery.each(jQuery(this)[0].attributes,function(e,i){if(-1!=i.name.indexOf("data-cond")){var t=i.name.slice(10),n=t.substring(1,0),a=t.slice(2);void 0===r[n]&&(r[n]={}),r[n][a]=i.value}}),jQuery.each(r,function(e,i){var t={field:{owner:n,action:i.action,parent:i.field,operator:i.operator,value:i.value,condition:{owner:n,action:i.action,operator:i.operator,value:i.value}}};arr_all_conditions.push(t)}),um_field_default_values[jQuery(this).data("key")]=um_get_field_default_value(jQuery(this))}),jQuery.each(e,function(e,i){um_field_conditions[i]=um_get_field_children(i)}),jQuery(".um-field[data-key]:visible").each(function(){var e=um_get_field_element(jQuery(this));void 0!==e.trigger&&e.trigger("change")})}jQuery(document).ready(function(){0<jQuery(".new-cond-form").length?(console.log("NEW"),0<jQuery(".um-field").length&&(condition_fields(),check_parent(),jQuery(".um-field input, .um-field textarea").on("change keyup",function(){condition_fields(),check_parent()}),jQuery(".um-field select").on("change",function(){condition_fields(),check_parent()}),jQuery(document).on("click",".um-modal .um-finish-upload",function(){condition_fields(),check_parent()}),jQuery(document).on("click",".um-field-area .cancel",function(){setTimeout(function(){condition_fields(),check_parent()})}))):(console.log("OLD"),jQuery(document).on("change",'.um-field select, .um-field input[type="radio"], .um-field input[type="checkbox"]',function(){um_apply_conditions(jQuery(this),!1)}),jQuery(document).on("input change",'.um-field input[type="text"]',function(){um_apply_conditions(jQuery(this),!1)}),jQuery(document).on("input change",'.um-field input[type="number"]',function(){um_apply_conditions(jQuery(this),!1)}),jQuery(document).on("input change",'.um-field input[type="password"]',function(){um_apply_conditions(jQuery(this),!1)}),jQuery(document).on("um_fields_change",function(){um_field_hide_siblings(),um_field_hide_siblings()}),um_init_field_conditions())});
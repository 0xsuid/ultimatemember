var um_members_directory_busy=[],um_member_directories=[];function um_parse_current_url(){var t={},i=window.location.search.substring(1).split("&");return jQuery.each(i,function(e){var r=i[e].split("=");t[r[0]]=r[1]}),t}function get_data_for_directory(r,e){var t={},i=um_parse_current_url();return jQuery.each(i,function(e){-1!==e.indexOf("_"+r)&&(t[e.replace("_"+r,"")]=i[e])}),e?t[e]:t}function um_members_get_hash(e){return e.data("hash")}function um_is_directory_busy(e){var r=um_members_get_hash(e);return void 0!==um_members_directory_busy[r]&&um_members_directory_busy[r]}function um_members_show_preloader(e){um_members_directory_busy[um_members_get_hash(e)]=!0,e.find(".um-members-overlay").show()}function um_members_hide_preloader(e){um_members_directory_busy[um_members_get_hash(e)]=!1,e.find(".um-members-overlay").hide()}function um_set_range_label(e,r){var t=e.siblings(".um-slider-range").data("placeholder");t=r?t.replace("{min_range}",r.values[0]).replace("{max_range}",r.values[1]).replace("{field_label}",e.siblings(".um-slider-range").data("label")):t.replace("{min_range}",e.slider("values",0)).replace("{max_range}",e.slider("values",1)).replace("{field_label}",e.siblings(".um-slider-range").data("label")),e.siblings(".um-slider-range").html(t),e.siblings(".um_range_min").val(e.slider("values",0)),e.siblings(".um_range_max").val(e.slider("values",1))}function um_ajax_get_members(i){var e=i.data("unique_id");e=e.replace("um-","");var r=-(new Date).getTimezoneOffset()/60,a={page:um_get_directory_storage(i,"page"),args:window["um_members_args_"+e],gmt_offset:r,nonce:um_scripts.nonce,referrer_url:window.location.href};return i.find(".um-member-directory-sorting-options").length&&(a.sorting=um_get_directory_storage(i,"sorting")),i.find(".um-search-line").length&&(a.general_search=um_get_directory_storage(i,"general_search")),i.find(".um-search-filter").length&&i.find(".um-search-filter").each(function(){var e=jQuery(this);if(e.find(".um-slider").length){var r=e.find(".um-slider").data("field_name");null!==(t=um_get_directory_storage(i,"filter_"+r))&&(a[r]=t,a.is_filters=!0)}else if(e.find(".um-datepicker-filter").length){r=e.find(".um-datepicker-filter").data("filter_name");null!==(t=um_get_directory_storage(i,"filter_"+r))&&(a[r]=t,a.is_filters=!0)}else{var t;r=e.find("select").attr("name");null!==(t=um_get_directory_storage(i,"filter_"+r))&&(a[r]=t,a.is_filters=!0)}}),wp.ajax.send("um_get_members",{data:a,success:function(e){um_set_directory_storage(i,"last_data",e,!0),um_build_template(i,e),um_members_hide_preloader(i);var r=wp.template("um-members-pagination");i.find(".um-members-pagination-box").html(r(e)),i.data("total_pages",e.pagination.total_pages),jQuery(document).trigger("um_members_rendered")},error:function(e){console.log(e)}})}function um_build_template(e,r){var t=um_get_directory_storage(e,"layout"),i=wp.template("um-member-"+t);e.find(".um-members-grid, .um-members-list").remove(),e.find(".um-members-wrapper").prepend(i(r)),e.addClass("um-loaded"),e.find(".um-members").length&&(UM_Member_Grid(e.find(".um-members")),jQuery(window).trigger("resize")),jQuery(document).trigger("um_build_template",[e,r]),jQuery(window).trigger("resize")}function UM_Member_Grid(e){e.find(".um-member").length&&e.imagesLoaded(function(){e.masonry({itemSelector:".um-member",columnWidth:".um-member",gutter:".um-gutter-sizer"}).on("layoutComplete",function(e,r){jQuery(document).trigger("um_grid_initialized",[e,r])})})}jQuery(".um-directory").each(function(){var e=jQuery(this);if(um_member_directories.push(e.data("hash")),um_members_show_preloader(e),e.find(".um-member-directory-view-type-a").length){var r=e.find(".um-member-directory-view-type-a").parent(),i=um_get_directory_storage(e,"layout"),a=r.find(".um-member-directory-view-type-a").length;r.find(".um-member-directory-view-type-a").each(function(e,r){if(jQuery(r).data("type")==i){if(jQuery(r).show(),e===a-1)var t=jQuery(r).prevAll().last().attr("default-title");else t=jQuery(r).next().attr("default-title");jQuery(r).attr("original-title",t)}else jQuery(r).hide()})}if(e.find(".um-member-directory-sorting-options").length){var t=um_set_directory_storage(e,"sorting",e.find(".um-member-directory-sorting-options").val());e.find(".um-member-directory-sorting-options").val(t),null!==(t=um_get_directory_storage(e,"sorting"))&&e.find(".um-member-directory-sorting-options").val(t).trigger("change")}var m=!1;if(e.find(".um-search-line").length){var u=um_get_directory_storage(e,"general_search");null!==u?e.find(".um-search-line").val(u):m=!0}jQuery("#tmpl-um-members-filtered-line").length&&um_change_tag(e),0<e.data("only_search")&&m?um_members_hide_preloader(e):um_ajax_get_members(e)}),jQuery(document).ready(function(){jQuery(".um-slider").each(function(){var e=jQuery(this),t=jQuery(this).parents(".um-directory"),r=get_data_for_directory(um_members_get_hash(t),e.data("field_name"));null==r&&(r=[parseInt(e.data("min")),parseInt(e.data("max"))]),e.slider({range:!0,min:parseInt(e.data("min")),max:parseInt(e.data("max")),values:r,create:function(e,r){},step:1,slide:function(e,r){um_set_range_label(jQuery(this),r)},stop:function(e,r){um_is_directory_busy(t)||(um_set_directory_storage(t,"filter_"+jQuery(this).data("field_name"),r.values,!0),um_set_directory_storage(t,"page",1,!0),um_change_tag(t),um_ajax_get_members(t))}}),um_set_range_label(e)}),jQuery(".um-datepicker-filter").each(function(){var n=jQuery(this),e=new Date(1e3*n.data("date_min")),r=new Date(1e3*n.data("date_max")),t=n.pickadate({selectYears:!0,min:e,max:r,formatSubmit:"yyyy/mm/dd",hiddenName:!0,onOpen:function(){n.blur()},onClose:function(){n.blur()},onSet:function(e){var r=n.parents(".um-directory");if(!um_is_directory_busy(r)){var t=n.data("filter_name"),i=n.data("range"),a=um_get_directory_storage(r,"filter_"+t);null===a&&(a={});var m=e.select/1e3,u=n.val();"from"===i?null===m||isNaN(m)?""==u&&delete a.from:a.from=m:"to"===i&&(null===m||isNaN(m)?""==u&&delete a.to:a.to=m),um_set_directory_storage(r,"filter_"+t,a,!0),um_set_directory_storage(r,"page",1,!0),um_ajax_get_members(r),um_change_tag(r)}}}).pickadate("picker"),i=n.data("filter_name"),a=n.data("range"),m=n.parents(".um-directory"),u=um_get_directory_storage(m,"filter_"+i);null!==u&&void 0!==u[a]&&t.set("select",1e3*u[a])}),jQuery(".um-members").each(function(){UM_Member_Grid(jQuery(this))}),jQuery(".um-directory .um-member-connect").each(function(){0==jQuery(this).find("a").length&&jQuery(this).remove()}),jQuery(".um-member-meta-main").each(function(){0==jQuery(this).find(".um-member-metaline").length&&0==jQuery(this).find(".um-member-connect").find("a").length&&jQuery(this).remove()}),jQuery(document.body).on("click",".um-member-more a",function(e){e.preventDefault();var r=jQuery(this).parents(".um-member"),t=jQuery(this).parents(".um-members");return r.find(".um-member-more").hide(),r.find(".um-member-meta").slideDown(function(){UM_Member_Grid(t)}),r.find(".um-member-less").fadeIn(),setTimeout(function(){UM_Member_Grid(t)},100),!1}),jQuery(document.body).on("click",".um-member-less a",function(e){e.preventDefault();var r=jQuery(this).parents(".um-member"),t=jQuery(this).parents(".um-members");return r.find(".um-member-less").hide(),r.find(".um-member-meta").slideUp(function(){r.find(".um-member-more").fadeIn(),UM_Member_Grid(t)}),!1}),jQuery(document.body).on("click",".um-do-search",function(e){return e.preventDefault(),jQuery(this).parents("form").find("input").filter(function(e){if(0===this.value.length)return!0}).prop("disabled",!0),jQuery(this).parents("form").find("select").filter(function(e){if(0===this.value.length)return!0}).prop("disabled",!0),jQuery(this).parents("form").submit(),!1}),jQuery(document.body).on("click",".um-member-directory-view-type-a",function(){var t=jQuery(this).parents(".um-directory");jQuery(this);if(um_is_directory_busy(t))return!1;var i,a,m=um_get_directory_storage(t,"layout"),e=t.find(".um-member-directory-view-type-a").parent(),u=jQuery(this).parent().find(".um-member-directory-view-type-a").length;e.find(".um-member-directory-view-type-a").each(function(e,r){jQuery(r).data("type")==m&&(e===u-1?(i=jQuery(r).parent().find(".um-member-directory-view-type-a").eq(0),a=jQuery(i).next().attr("default-title")):(i=jQuery(r).parent().find(".um-member-directory-view-type-a").eq(e+1),a=e===u-2?jQuery(r).parent().find(".um-member-directory-view-type-a").eq(0).attr("default-title"):jQuery(i).next().attr("default-title")))}),jQuery(this).parent().find(".um-member-directory-view-type-a").hide(),i.show(),i.attr("original-title",a),m=jQuery(i).data("type"),um_set_directory_storage(t,"layout",m,!0),t.data("view_type",m);var r=um_get_directory_storage(t,"last_data");if(null!==r)um_build_template(t,r);else{var n=!1;if(t.find(".um-search-line").length)null===um_get_directory_storage(t,"general_search")&&(n=!0);if(jQuery("#tmpl-um-members-filtered-line").length){var s=[];t.find(".um-search-filter").each(function(){var e=jQuery(this).find("select").attr("name"),r=um_get_directory_storage(t,"filter_"+e);void 0!==r&&("string"==typeof r?s.push({name:e}):jQuery.each(r,function(){s.push({name:e})}))}),n=s.length<=0}if(1===parseInt(t.data("only_search"))&&n)return;um_members_show_preloader(t),um_ajax_get_members(t)}}),jQuery(".um-member-directory-filters").click(function(){var e=jQuery(this).parents(".um-directory").find(".um-search");e.is(":visible")?e.slideUp(650):e.slideDown(650)}),jQuery(".um-close-filter").click(function(){jQuery(this).parents(".um-directory").find(".um-search").slideUp(650)}),jQuery(document.body).on("change",".um-search-filter select",function(){if(""!==jQuery(this).val()){var e=jQuery(this).parents(".um-directory");if(!um_is_directory_busy(e)){var r=jQuery(this).prop("name"),t=um_get_directory_storage(e,"filter_"+r);null===t&&(t=[]),-1===jQuery.inArray(jQuery(this).val(),t)&&(t.push(jQuery(this).val()),um_set_directory_storage(e,"filter_"+r,t,!0),um_set_directory_storage(e,"page",1,!0)),jQuery(this).val("").trigger("change"),um_ajax_get_members(e),um_change_tag(e)}}}),jQuery(document.body).on("click",".um-members-filter-remove",function(){var e=jQuery(this).parents(".um-directory");if(!um_is_directory_busy(e)){var r=jQuery(this).data("range"),t=jQuery(this).data("value"),i=jQuery(this).data("name"),a=um_get_directory_storage(e,"filter_"+i);if(null!==a&&-1!=jQuery.inArray(t.toString(),a))0<(a=jQuery.grep(a,function(e){return e!=t})).length?um_set_directory_storage(e,"filter_"+i,a,!0):um_delete_directory_storage(e,"filter_"+i),um_set_directory_storage(e,"page",1,!0),jQuery(this).parents(".um-members-filter-tag").remove();else if(null!==a&&void 0!==a[r])e.find('input.um-datepicker-filter[data-filter_name="'+i+'"][data-range="'+r+'"]').val("").change(),delete a[r],!1===jQuery.isEmptyObject(a)?um_set_directory_storage(e,"filter_"+i,a,!0):um_delete_directory_storage(e,"filter_"+i),jQuery(this).parents(".um-members-filter-tag").remove();else{1<a.length&&a.includes(t)?(a.splice(a.indexOf(t),1),um_set_directory_storage(e,"filter_"+i,a,!0)):um_delete_directory_storage(e,"filter_"+i),jQuery(this).parents(".um-members-filter-tag").remove();var m=jQuery(e).find("div.um-slider");m.slider("values",[parseInt(m.data("min")),parseInt(m.data("max"))])}um_ajax_get_members(e),0===e.find(".um-members-filter-remove").length?e.find(".um-clear-filters-a").hide():e.find(".um-clear-filters-a").show()}}),jQuery(document.body).on("click",".um-clear-filters-a",function(){var m=jQuery(this).parents(".um-directory");um_is_directory_busy(m)||(m.find(".um-members-filter-remove").each(function(){var r=jQuery(this).data("value"),e=jQuery(this).data("name"),t=jQuery(this).data("range"),i=um_get_directory_storage(m,"filter_"+e);if(null!==i&&-1!=jQuery.inArray(r.toString(),i))0<(i=jQuery.grep(i,function(e){return e!=r})).length?um_set_directory_storage(m,"filter_"+e,i,!0):um_delete_directory_storage(m,"filter_"+e),um_set_directory_storage(m,"page",1,!0),jQuery(this).parents(".um-members-filter-tag").remove();else if(null!==i&&void 0!==i[t])m.find('input.um-datepicker-filter[data-filter_name="'+e+'"][data-range="'+t+'"]').val("").change(),delete i[t],!1===jQuery.isEmptyObject(i)?um_set_directory_storage(m,"filter_"+e,i,!0):um_delete_directory_storage(m,"filter_"+e),jQuery(this).parents(".um-members-filter-tag").remove();else{um_delete_directory_storage(m,"filter_"+e),jQuery(this).parents(".um-members-filter-tag").remove();var a=jQuery(m).find("div.um-slider");a.slider("values",[parseInt(a.data("min")),parseInt(a.data("max"))]),um_set_range_label(a)}}),um_set_directory_storage(m,"page",1,!0),m.find(".um-members-filter-tag").remove(),um_ajax_get_members(m),jQuery(this).hide())})});
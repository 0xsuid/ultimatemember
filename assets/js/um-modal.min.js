!function(d){function t(){this.M=[],this.defaultOptions={classes:"",duration:400,footer:"",header:"",id:"",remoteContent:"",size:"normal",template:""},this.defaultTemplate='<div class="um-modal"><span class="um-modal-close umModalClose"><i class="um-faicon-times"></i></span><div class="um-modal-header"></div><div class="um-modal-body"></div><div class="um-modal-footer"></div></div>',this.loading=!1}t.prototype={constructor:t,addModal:function(t,o,e){o=this.getOptions(o);let i;if(o.template){let t=wp.template(o.template);t&&(i=d(t(o)))}i||(i=d(this.defaultTemplate),o.header||i.find(".um-modal-header").remove(),o.footer||i.find(".um-modal-footer").remove());let n=i.find(".um-modal-body");if("loading"===t?this.loading=!0:this.isValidHttpUrl(t)?(this.loading=!0,n.load(t,function(){n.removeClass("loading"),UM.modal.responsive(i)})):"string"==typeof o.remoteContent&&o.remoteContent?(this.loading=!0,n.load(o.remoteContent,function(){n.removeClass("loading"),UM.modal.responsive(i)})):"function"==typeof t?"object"==typeof(e=t.apply(i,[e,o]))&&e instanceof jqXHR?(this.loading=!0,wp.hooks.doAction("um-modal-before-ajax",i,o,jqXHR)):(n.append(e),wp.hooks.doAction("um-modal-before-add",i,o)):("object"==typeof t?n.append(d(t).clone()):n.append(t),wp.hooks.doAction("um-modal-before-add",i,o)),o.id.length&&i.attr("id",o.id),o.classes.length&&i.addClass(o.classes),o.size.length&&i.addClass(o.size),this.loading)i.addClass("loading");else{let t=n.find("img");t.length&&t.on("load",function(){UM.modal.responsive(i)})}return i.on("click",'a:not([href^="javascript"])',this.stopEvent),i.on("touchmove",this.stopEvent),this.hide(),this.M.push(i),this.show(i,o.duration),i},addOverlay:function(){return d("body > .um-modal-overlay").length<1&&d(document.body).addClass("um-overflow-hidden").append('<div class="um-modal-overlay"></div>').on("touchmove",this.stopEvent),d("body > .um-modal-overlay")},clear:function(){this.M=[],d(document.body).removeClass("um-overflow-hidden").off("touchmove").children(".um-modal-overlay, .um-modal").remove(),"hidden"===d(document.body).css("overflow-y")&&d(document.body).css("overflow-y","visible")},close:function(){let o=this.getModal();if(wp.hooks.doAction("um-modal-before-close",o),o){let t=o.find("div.um-admin-editor:visible");0<t.length&&("object"==typeof tinyMCE&&tinyMCE.triggerSave(),"object"==typeof $um_tiny_editor&&d("div.um_tiny_placeholder:empty").replaceWith($um_tiny_editor.html()),t.find("#wp-um_editor_edit-wrap").remove())}1<this.M.length?(this.M.pop().remove(),this.show()):this.clear()},getModal:function(e){let i;return"object"==typeof e?i=d(e):"string"==typeof e&&1<=this.M.length?d.each(this.M,function(t,o){o.is(e)&&(i=o)}):i=1<=this.M.length?this.M[this.M.length-1]:d("div.um-modal:not(.um-modal-hidden)").filter(":visible"),i.length?i.last():null},getOptions:function(t){var o=wp.hooks.applyFilters("um-modal-def-options",this.defaultOptions);return d.extend(o,t||{})},hide:function(t){let o=this.getModal(t);if(o)return o.detach(),wp.hooks.doAction("um-modal-hidden",o),o},isValidHttpUrl:function(t){let o;try{o=new URL(t)}catch(t){return!1}return"http:"===o.protocol||"https:"===o.protocol},responsive:function(e){let i=this.getModal(e);if(i){i.removeClass("uimob340").removeClass("uimob500").removeClass("uimob800").removeClass("uimob960");var n=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,e=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let t=d(".um-modal-body > img").filter(":visible"),o={};t.length?(t.css({maxHeight:.8*e,maxWidth:.8*n}),o.bottom=(e-i.innerHeight())/2+"px",o.marginLeft="-"+t.width()/2+"px",o.width=t.width()):(n<=340?(o.bottom=0,o.height=e,o.width=n,i.addClass("uimob340")):n<=500?(o.bottom=0,o.height=e,o.width=n,i.addClass("uimob500")):n<=800?(o.bottom=(e-i.innerHeight())/2+"px",o.maxHeight=e,i.addClass("uimob800"),o.maxHeight=e):n<=960?(o.bottom=(e-i.innerHeight())/2+"px",o.maxHeight=e,i.addClass("uimob960")):960<n&&(o.bottom=(e-i.innerHeight())/2+"px",o.maxHeight=e),i.width()>n&&(o.width=.8*n,o.marginLeft="-"+o.width/2+"px")),o=wp.hooks.applyFilters("um-modal-responsive",o,i),i.css(o)}},setContent:function(t,o){let e=this.getModal(o);e.find(".um-modal-body").html(t),this.responsive(e)},show:function(t,o){let e=this.getModal(t);if(e)return this.addOverlay().after(e),this.responsive(e),e.animate({opacity:1},o||10),wp.hooks.doAction("um-modal-shown",e),e},stopEvent:function(t){t.preventDefault(),t.stopPropagation()}},void 0===window.UM&&(window.UM={}),UM.modal=new t,d(document.body).on("click",".um-modal-overlay, .umModalClose",function(t){t.preventDefault(),UM.modal.close()}),d.fn.umModal=function(t){UM.modal.addModal(this.clone(),t)},d.fn.umModalBtn=function(o,e){this.on("click",function(t){t.preventDefault(),UM.modal.addModal(o,e,t)})}}(jQuery);